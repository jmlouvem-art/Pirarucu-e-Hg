<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Pirarucu Aventureiro</title>

<link rel="icon" type="image/png" href="logo 2.png" sizes="32x32">
<link rel="apple-touch-icon" href="logo 2.png">
<meta name="theme-color" content="#f59e0b">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">

<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    width: 100%;
    font-family: 'Nunito', sans-serif;
    background-color: #0c4a6e;
  }

  #game-container {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    background-color: #0c4a6e;
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
  }

  /* Fundo por orienta√ß√£o */
  @media (orientation: landscape) {
    canvas, .modal-water { background-image: url('Fundo pc.png'); }
  }
  @media (orientation: portrait) {
    canvas, .modal-water { background-image: url('Fundo do Lago.png'); }
  }

  .modal { transition: opacity .3s ease-in-out; }
  .particle { position: absolute; pointer-events: none; width: 5px; height: 5px; border-radius: 50%; animation: fade 1s forwards; }
  @keyframes fade { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(.5) translateY(-50px); } }
</style>
</head>

<body>

<!-- Modal Nome -->
<div id="name-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120]">
  <div class="rounded-lg p-6 text-center shadow-xl max-w-sm w-full bg-cover bg-center modal-water">
    <div class="bg-white bg-opacity-80 p-4 shadow-md">
      <div class="flex justify-center mb-4"><img src="logo 2.png" class="w-[210px] h-auto shadow-lg" alt=""></div>
      <h2 class="text-2xl font-bold mb-4">üêü Bem-vindo!</h2>
      <p class="mb-4">Digite seu nome para come√ßar:</p>
      <input id="player-name-input" class="border-2 border-blue-500 rounded-lg px-4 py-2 w-full mb-4 text-center" maxlength="20" placeholder="Seu nome" autofocus>
      <button id="name-submit-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Continuar</button>
    </div>
  </div>
</div>

<!-- Container do jogo -->
<div id="game-container" class="hidden">
  <!-- HUD -->
  <div class="p-3 bg-blue-200/80 text-gray-800 flex justify-between items-center z-20">
    <div class="flex items-center gap-2">
      <img src="logo 2.png" class="w-8 h-8 object-contain" alt="">
      <div>
        <h1 class="text-lg font-bold">Pirarucu Aventureiro</h1>
        <div class="text-xs">Jogador: <span id="player-name-display" class="font-bold">-</span></div>
        <div class="text-xs">N√≠vel: <span id="level">1</span></div>
      </div>
    </div>
    <div class="text-right">
      <div class="font-bold">Pontos: <span id="score">0</span></div>
      <div class="text-xs">Recorde: <span id="high-score">0</span></div>
    </div>
  </div>

  <!-- Canvas -->
  <div class="flex-1 relative overflow-hidden">
    <canvas id="gameCanvas" class="absolute inset-0 w-full h-full"></canvas>
  </div>

  <!-- Barra Hg -->
  <div class="absolute top-24 right-3 w-12 text-center z-20 pointer-events-none">
    <div class="text-white text-sm font-bold mb-1">Hg</div>
    <div class="relative h-64 w-6 bg-white bg-opacity-30 rounded-full overflow-hidden mx-auto border-2 border-white/50">
      <div id="mercury-bar" class="absolute bottom-0 w-full bg-red-600 transition-all duration-300" style="height:0%;"></div>
    </div>
    <div class="text-white text-xs mt-1"><span id="mercury-percent">0</span>%</div>
  </div>

  <div id="game-message"
       class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white text-3xl font-bold z-30 opacity-0 pointer-events-none text-center drop-shadow-lg">
  </div>
</div>

<!-- Modal In√≠cio -->
<div id="start-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl w-full max-w-md mx-auto">
    <img src="logo 2.png" class="mx-auto mb-4 w-40 h-auto shadow" alt="">
    <h2 class="text-2xl font-bold mb-2">üêü Pirarucu Aventureiro</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-left mb-4">
      <p class="font-bold text-green-600">üü¢ Peixes Seguros:<br>Tambaqui, Pacu, Aruan√£</p>
      <p class="font-bold text-red-600">üî¥ Contaminados:<br>Tucunar√©, Surubim, Piranha</p>
    </div>
    <p class="mb-3 text-sm">Colete peixes seguros e evite os contaminados!</p>
    <p class="mb-6 text-sm">Arraste o dedo ou o mouse para mover o Pirarucu.</p>
    <button id="start-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full">Come√ßar</button>
  </div>
</div>

<!-- Game Over -->
<div id="game-over-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl max-w-sm">
    <h2 class="text-2xl font-bold mb-2 text-red-600">Fim de Jogo</h2>
    <p>Jogador: <span id="final-player-name" class="font-bold">-</span></p>
    <p>Pontua√ß√£o: <span id="final-score" class="font-bold text-blue-600">0</span></p>
    <p>N√≠vel: <span id="final-level" class="font-bold">1</span></p>
    <button id="restart-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Jogar Novamente</button>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const canvas = document.getElementById("gameCanvas"),
        ctx = canvas.getContext("2d");
  const scoreEl = document.getElementById("score"),
        levelEl = document.getElementById("level"),
        mercuryBarEl = document.getElementById("mercury-bar"),
        mercuryPercentEl = document.getElementById("mercury-percent"),
        nameModal = document.getElementById("name-modal"),
        startModal = document.getElementById("start-modal"),
        gameOverModal = document.getElementById("game-over-modal"),
        nameSubmitButton = document.getElementById("name-submit-button"),
        playerNameInput = document.getElementById("player-name-input"),
        startButton = document.getElementById("start-button"),
        restartButton = document.getElementById("restart-button"),
        playerNameDisplay = document.getElementById("player-name-display");

  let playerName = "", player, score = 0, level = 1, mercury = 0, fish = [], gameRunning = false;

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();

  const fishData = [
    { name: "Tambaqui", points: 10, mercury: 0, color: "#0f0" },
    { name: "Pacu", points: 10, mercury: 0, color: "#0f0" },
    { name: "Aruan√£", points: 15, mercury: 0, color: "#0f0" },
    { name: "Castanha", points: 20, mercury: -10, color: "#ff0" },
    { name: "Tucunar√©", points: -5, mercury: 25, color: "#f00" },
    { name: "Surubim", points: -5, mercury: 30, color: "#f00" },
    { name: "Piranha", points: -5, mercury: 20, color: "#f00" }
  ];

  const fishImages = {
    'Aruan√£': new Image(),
    'Castanha': new Image(),
    'Pacu': new Image(),
    'Piranha': new Image(),
    'Surubim': new Image(),
    'Tambaqui': new Image(),
    'Tucunar√©': new Image()
  };

  fishImages['Aruan√£'].src = 'Aruana.png';
  fishImages['Castanha'].src = 'Castanha.png';
  fishImages['Pacu'].src = 'Pacu.png';
  fishImages['Piranha'].src = 'Piranha.png';
  fishImages['Surubim'].src = 'Surubim.png';
  fishImages['Tambaqui'].src = 'Tambaqui.png';
  fishImages['Tucunar√©'].src = 'Tucunare.png';

  player = { x: window.innerWidth / 2, y: window.innerHeight - 120, w: 160, h: 160, targetX: window.innerWidth / 2 };

  const img = new Image();
  img.src = "pirarucu m.png";

  function drawPlayer() {
    if (img.complete) ctx.drawImage(img, player.x - player.w / 2, player.y - player.h / 2, player.w, player.h);
  }

  // Alterando a taxa de apari√ß√£o dos peixes e a dificuldade
  let fishSpawnRate = 0.02;  // A chance de gerar peixe vai continuar fixa
  let fishSpeed = 2 + level * 0.2; // Aumentando a velocidade dos peixes conforme o n√≠vel
  let castanhaChance = 0.05; // Chance inicial da Castanha aparecer

  function createFish() {
    // A chance da Castanha aparecer diminui conforme o n√≠vel
    if (Math.random() < fishSpawnRate) {
      const isCastanha = Math.random() < castanhaChance;
      const d = isCastanha ? fishData.find(f => f.name === 'Castanha') : fishData[Math.floor(Math.random() * fishData.length)];

      fish.push({ x: Math.random() * canvas.width, y: -50, dy: fishSpeed, data: d });

      // Reduz a chance da Castanha aparecer conforme o n√≠vel
      castanhaChance = Math.max(0.01, castanhaChance - 0.005 * level);  // Nunca menos que 1% de chance
    }
  }

  function drawFish(f) {
    ctx.fillStyle = f.data.color;
    ctx.beginPath();
    ctx.arc(f.x, f.y, 35, 0, Math.PI * 2);  // Aumentei o tamanho do peixe
    ctx.fill();
    const img = fishImages[f.data.name];
    if (img && img.complete && img.naturalWidth > 0) {
      ctx.drawImage(img, f.x - 35, f.y - 35, 70, 70);  // Ajustei o tamanho do peixe ao tamanho maior
    }
  }

  function checkCollision(f) {
    const dx = f.x - player.x, dy = f.y - player.y, dist = Math.sqrt(dx * dx + dy * dy);
    return dist < 90;  // Ajustei a colis√£o para o tamanho do peixe maior
  }

  function showMessage(msg, color) {
    const el = document.getElementById("game-message");
    el.textContent = msg;
    el.style.color = color;
    el.style.opacity = 1;
    setTimeout(() => el.style.opacity = 0, 1000);
  }

  function loop() {
    if (!gameRunning) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    player.x += (player.targetX - player.x) * 0.1;
    drawPlayer();
    fish.forEach(f => {
      f.y += f.dy;
      drawFish(f);
      if (checkCollision(f)) {
        score += f.data.points;
        mercury = Math.max(0, Math.min(100, mercury + f.data.mercury));
        showMessage(`${f.data.points > 0 ? '+' : ''}${f.data.points} pts`, f.data.mercury > 0 ? "#f00" : "#0f0");
        fish.splice(fish.indexOf(f), 1);
        if (mercury >= 100) endGame();
      }
    });
    createFish(); // Criar novos peixes conforme a taxa ajustada
    mercuryBarEl.style.height = mercury + "%";
    mercuryPercentEl.textContent = mercury;
    scoreEl.textContent = score;
    if (score >= level * 100) levelUp();
    requestAnimationFrame(loop);
  }

  function startGame() {
    score = 0;
    level = 1;
    mercury = 0;
    fish = [];
    gameRunning = true;
    startModal.classList.add("hidden");
    resizeCanvas();
    loop();
  }

  function levelUp() {
    level++;
    levelEl.textContent = level;
    fishSpeed = 2 + level * 0.2;  // Aumenta a velocidade de queda dos peixes
    showMessage(`N√≠vel ${level}!`, "#0f0");
  }

  function endGame() {
    gameRunning = false;
    document.getElementById("final-score").textContent = score;
    document.getElementById("final-level").textContent = level;
    document.getElementById("final-player-name").textContent = playerName;
    gameOverModal.classList.remove("hidden");
    gameOverModal.style.opacity = 1;
  }

  // Fun√ß√£o para salvar o ranking no localStorage
  function saveRanking() {
    const ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    ranking.push({ name: playerName, score, level });
    ranking.sort((a, b) => b.score - a.score);
    localStorage.setItem('ranking', JSON.stringify(ranking.slice(0, 10)));  // Limita a 10 melhores
  }

  // Fun√ß√£o para mostrar o ranking
  function showRanking() {
    const ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    console.log('Ranking:', ranking);
    ranking.forEach((entry, index) => {
      console.log(`${index + 1}. ${entry.name} - ${entry.score} pontos (N√≠vel ${entry.level})`);
    });
  }

  canvas.addEventListener("mousemove", e => player.targetX = e.clientX);
  canvas.addEventListener("touchmove", e => {
    const t = e.touches[0];
    if (t) player.targetX = t.clientX;
  });

  nameSubmitButton.onclick = () => {
    const n = playerNameInput.value.trim();
    if (!n) { alert("Digite seu nome!"); return; }
    playerName = n;
    playerNameDisplay.textContent = n;
    nameModal.classList.add("hidden");
    startModal.classList.remove("hidden");
    startModal.style.opacity = 1;
  };

  playerNameInput.addEventListener("keydown", e => {
    if (e.key === "Enter") nameSubmitButton.click();
  });

  startButton.onclick = startGame;
  restartButton.onclick = () => {
    gameOverModal.classList.add("hidden");
    saveRanking();  // Salvar no ranking quando o jogo termina
    startGame();
  };
});
</script>

</body>
</html>
