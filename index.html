<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pirarucu Aventureiro</title>

<link rel="icon" type="image/png" href="logo 2.png" sizes="32x32">
<link rel="apple-touch-icon" href="logo 2.png">
<meta name="theme-color" content="#f59e0b">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">

<style>
html,body{overscroll-behavior:none;}
*{-webkit-tap-highlight-color:transparent;}
body{font-family:'Nunito',sans-serif;touch-action:none;user-select:none;-webkit-user-select:none;}
canvas{background-size:cover;background-position:center;display:block;}
/* fundo alterna conforme orientação */
@media(orientation:landscape){
  canvas,.modal-water{background-image:url('Fundo pc.png');}
}
@media(orientation:portrait){
  canvas,.modal-water{background-image:url('Fundo do Lago.png');}
}
.modal{transition:opacity .3s ease-in-out;}
@keyframes particleFade{0%{opacity:1;transform:scale(1);}100%{opacity:0;transform:scale(.5) translateY(-50px);}}
.particle{position:absolute;pointer-events:none;animation:particleFade 1s ease-out forwards;}
.ranking-entry{transition:all .3s ease;}
.ranking-entry:hover{transform:scale(1.02);background-color:rgba(59,130,246,.1);}
@keyframes hudFade{0%{opacity:0;transform:translateY(-2px);}10%{opacity:1;transform:translateY(0);}90%{opacity:1;}100%{opacity:0;transform:translateY(-2px);}}
.hud-note-show{animation:hudFade 3s ease-in-out forwards;}
</style>
</head>

<body class="bg-blue-900 flex flex-col items-center justify-center min-h-[100svh] overflow-hidden">

<!-- modal nome -->
<div id="name-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120]">
  <div class="rounded-lg p-6 text-center shadow-xl max-w-sm w-full bg-cover bg-center modal-water">
    <div class="bg-white bg-opacity-80 p-4 shadow-md">
      <div class="flex justify-center mb-4"><img src="logo 2.png" class="w-[210px] h-auto shadow-lg"></div>
      <h2 class="text-2xl font-bold mb-4">🐟 Bem-vindo!</h2>
      <p class="mb-4">Digite seu nome para começar:</p>
      <input type="text" id="player-name-input" placeholder="Seu nome"
        class="border-2 border-blue-500 rounded-lg px-4 py-2 w-full mb-4 text-center" maxlength="20">
      <button id="name-submit-button"
        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Continuar</button>
      <button id="view-ranking-button"
        class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg w-full">Ver Ranking</button>
    </div>
  </div>
</div>

<!-- container jogo -->
<div id="game-container" class="hidden relative bg-blue-800 shadow-2xl flex flex-col" style="width:100%;height:auto;">
  <!-- HUD -->
  <div class="p-3 bg-blue-200/80 text-gray-800 flex justify-between items-center z-20">
    <div class="flex items-center gap-2">
      <img src="logo 2.png" class="w-8 h-8 object-contain">
      <div class="leading-tight">
        <h1 class="text-xl font-bold">Pirarucu Aventureiro</h1>
        <div class="text-xs">Jogador: <span id="player-name-display" class="font-bold">-</span></div>
        <div class="text-xs flex items-center gap-2">
          Nível: <span id="level">1</span>
          <span id="hud-note" class="hidden px-2 py-0.5 rounded-full text-white text-[10px] font-bold leading-none select-none"></span>
        </div>
      </div>
    </div>
    <div class="text-right">
      <div class="font-bold">Pontos: <span id="score">0</span></div>
      <div class="text-xs">Recorde: <span id="high-score">0</span></div>
    </div>
  </div>

  <canvas id="gameCanvas" class="flex-1 w-full"></canvas>

  <!-- barra Hg -->
  <div class="absolute top-24 right-3 w-12 text-center z-10 pointer-events-none">
    <div class="text-white text-sm font-bold mb-1">Hg</div>
    <div class="relative h-64 w-6 bg-white bg-opacity-30 rounded-full overflow-hidden mx-auto border-2 border-white/50">
      <div id="mercury-bar" class="absolute bottom-0 w-full bg-red-600 transition-all duration-300" style="height:0%;"></div>
    </div>
    <div class="text-white text-xs mt-1"><span id="mercury-percent">0</span>%</div>
  </div>

  <div id="game-message" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white text-3xl font-bold z-20 opacity-0 pointer-events-none text-center drop-shadow-lg"></div>
  <div id="fact-display" class="absolute bottom-20 left-1/2 -translate-x-1/2 bg-black bg-opacity-70 text-white text-sm p-3 rounded-lg max-w-xs text-center z-10 opacity-0 pointer-events-none"></div>
</div>

<!-- start modal -->
<div id="start-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl w-full max-w-md mx-auto">
    <img src="logo 2.png" class="mx-auto mb-4 w-40 h-auto shadow">
    <h2 class="text-2xl font-bold mb-2">🐟 Pirarucu Aventureiro</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-left mb-4">
      <p class="font-bold text-green-600">🟢 Seguros:<br>Tambaqui, Pacu, Aruanã</p>
      <p class="font-bold text-red-600">🔴 Contaminados:<br>Tucunaré, Surubim, Piranha</p>
    </div>
    <p class="mb-3 text-sm">Colete peixes seguros e evite os contaminados!</p>
    <button id="start-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full">Começar</button>
    <p class="mt-4 text-xs text-gray-500">Desenvolvido por <strong>Júlia Maretti Louvem</strong> e <strong>Yan Ribeiro de Paiva</strong></p>
  </div>
</div>

<!-- game over modal -->
<div id="game-over-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl max-w-sm">
    <h2 class="text-2xl font-bold mb-2 text-red-600">Fim de Jogo</h2>
    <p id="game-over-reason" class="mb-4">A contaminação por mercúrio atingiu um nível crítico.</p>
    <div id="new-record-message" class="mb-4 p-3 bg-yellow-100 border-2 border-yellow-400 rounded-lg hidden">
      <p class="text-lg font-bold text-yellow-700">🎉 Novo Recorde!</p>
    </div>
    <p>Jogador: <span id="final-player-name" class="font-bold">-</span></p>
    <p>Sua pontuação: <span id="final-score" class="font-bold text-blue-600">0</span></p>
    <p>Nível: <span id="final-level" class="font-bold">1</span></p>
    <button id="restart-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Jogar Novamente</button>
    <button id="view-ranking-gameover-button" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg w-full">Ver Ranking</button>
    <p class="mt-4 text-xs text-gray-500">Desenvolvido por <strong>Júlia Maretti Louvem</strong> e <strong>Yan Ribeiro de Paiva</strong></p>
  </div>
</div>

<!-- ranking modal -->
<div id="ranking-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto">
    <h2 class="text-2xl font-bold mb-4 text-center">🏆 Ranking</h2>
    <div id="ranking-list" class="space-y-2"></div>
    <button id="close-ranking-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mt-4">Fechar</button>
  </div>
</div>

<script>
const canvas=document.getElementById('gameCanvas'),ctx=canvas.getContext('2d');
const scoreEl=document.getElementById('score'),highScoreEl=document.getElementById('high-score'),levelEl=document.getElementById('level');
const mercuryBarEl=document.getElementById('mercury-bar'),mercuryPercentEl=document.getElementById('mercury-percent');
const gameContainer=document.getElementById('game-container'),gameMessageEl=document.getElementById('game-message'),factDisplayEl=document.getElementById('fact-display');
const playerNameDisplayEl=document.getElementById('player-name-display');
const nameModal=document.getElementById('name-modal'),startModal=document.getElementById('start-modal'),gameOverModal=document.getElementById('game-over-modal'),rankingModal=document.getElementById('ranking-modal');
const playerNameInput=document.getElementById('player-name-input'),nameSubmitButton=document.getElementById('name-submit-button'),viewRankingButton=document.getElementById('view-ranking-button');
const startButton=document.getElementById('start-button'),restartButton=document.getElementById('restart-button'),viewRankingGameoverButton=document.getElementById('view-ranking-gameover-button'),closeRankingButton=document.getElementById('close-ranking-button');
const finalScoreEl=document.getElementById('final-score'),finalLevelEl=document.getElementById('final-level'),finalPlayerNameEl=document.getElementById('final-player-name'),newRecordMessageEl=document.getElementById('new-record-message'),rankingListEl=document.getElementById('ranking-list');

let score=0,highScore=0,level=1,mercuryLevel=0,gameRunning=false,infoPopupShown=false,playerName='',player,fish,bubbles;

function resizeCanvas(){
 const MAX_W=1100,MAX_H=1100,VIEW_W=Math.min(window.innerWidth*.98,MAX_W),VIEW_H=Math.min(window.innerHeight*.85,MAX_H),ASPECT=16/9;
 let w=VIEW_W,h=w/ASPECT;if(h>VIEW_H){h=VIEW_H;w=h*ASPECT;}
 gameContainer.style.width=w+'px';gameContainer.style.height=h+'px';
 const hud=gameContainer.querySelector('.p-3.bg-blue-200\\/80');const hudH=hud?hud.getBoundingClientRect().height:0;
 const cH=Math.max(100,h-hudH),cW=w,dpr=Math.max(1,Math.floor(window.devicePixelRatio||1));
 canvas.style.width=cW+'px';canvas.style.height=cH+'px';canvas.width=cW*dpr;canvas.height=cH*dpr;ctx.setTransform(dpr,0,0,dpr,0,0);
}

let _resizeRAF=null;function onResize(){if(_resizeRAF)cancelAnimationFrame(_resizeRAF);_resizeRAF=requestAnimationFrame(()=>resizeCanvas());}
window.addEventListener('resize',onResize);window.addEventListener('orientationchange',()=>setTimeout(onResize,150));

function showHudNote(t,c='green'){const e=document.getElementById('hud-note');
e.classList.remove('bg-green-600','bg-blue-600','bg-yellow-600','bg-red-600','hud-note-show','hidden');
const map={green:'bg-green-600',blue:'bg-blue-600',yellow:'bg-yellow-600',red:'bg-red-600'};e.classList.add(map[c]||'bg-green-600');
e.textContent=t;e.classList.add('hud-note-show');levelEl.classList.add('ring','ring-offset-1','ring-green-400','rounded-sm');
setTimeout(()=>levelEl.classList.remove('ring','ring-offset-1','ring-green-400','rounded-sm'),1e3);
setTimeout(()=>{e.classList.add('hidden');e.classList.remove('hud-note-show');},3e3);}

function showInfoModal(){infoPopupShown=true;showHudNote('ⓘ Dica: carnívoros ↑ Hg','blue');}
function levelUp(){level++;showHudNote('⬆ Nível '+level+'! Peixes +rápidos','green');updateHUD();}
function updateHUD(){scoreEl.textContent=score;highScoreEl.textContent=highScore;levelEl.textContent=level;mercuryBarEl.style.height=mercuryLevel+'%';mercuryPercentEl.textContent=Math.round(mercuryLevel);}
function gameOver(){gameRunning=false;finalScoreEl.textContent=score;finalLevelEl.textContent=level;finalPlayerNameEl.textContent=playerName;
if(score>highScore)newRecordMessageEl.classList.remove('hidden');else newRecordMessageEl.classList.add('hidden');
addToRanking(playerName,score,level);gameOverModal.classList.remove('hidden');setTimeout(()=>gameOverModal.style.opacity='1',10);}
function showMessage(t,c){gameMessageEl.textContent=t;gameMessageEl.style.color=c;gameMessageEl.style.opacity='1';setTimeout(()=>gameMessageEl.style.opacity='0',1e3);}
function createParticles(x,y,color){for(let i=0;i<10;i++){const p=document.createElement('div');p.className='particle';p.style.left=x+'px';p.style.top=y+'px';p.style.width='5px';p.style.height='5px';p.style.backgroundColor=color;p.style.borderRadius='50%';gameContainer.appendChild(p);setTimeout(()=>p.remove(),1e3);}}

const fishData={safe:[{name:'Tambaqui',points:10,mercury:5,color:'#FFD700'},{name:'Pacu',points:10,mercury:5,color:'#FFA500'},{name:'Aruanã',points:15,mercury:8,color:'#FFFF00'},{name:'Castanha',points:20,mercury:-10,color:'#8B4513'}],
contaminated:[{name:'Tucunaré',points:-5,mercury:25,color:'#8B0000'},{name:'Surubim',points:-5,mercury:30,color:'#A52A2A'},{name:'Piranha',points:-5,mercury:20,color:'#DC143C'}]};
const educationalFacts=["Peixes carnívoros acumulam 6,5x mais mercúrio.","21,3% dos peixes têm níveis perigosos.","O mercúrio é usado no garimpo.","Afeta povos indígenas e ribeirinhos.","Causa danos neurológicos.","Gestantes e crianças são vulneráveis.","Permanece décadas no ambiente.","≈200 t/ano chegam à Amazônia."];
let lastFactTime=0,factInterval=15000;

function init(){resizeCanvas();score=0;level=1;mercuryLevel=0;infoPopupShown=false;lastFactTime=Date.now();
player={x:canvas.width/2,y:canvas.height/2,width:160,height:160,targetX:canvas.width/2};highScore=getPlayerHighScore(playerName);
updateHUD();fish=[];bubbles=[];for(let i=0;i<15;i++)bubbles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,radius:Math.random()*10+5,speed:Math.random()*.5+.2});}

function createFish(){let fT,castChance=mercuryLevel>=50?.2:.05;if(Math.random()<castChance)fT=fishData.safe.find(f=>f.name==='Castanha');else{const ok=Math.random()<.6,arr=ok?fishData.safe:fishData.contaminated;fT=arr[Math.floor(Math.random()*arr.length)];}
const w=fT.name==='Castanha'?60:120;fish.push({x:Math.random()*(canvas.width-w)+w/2,y:-w,width:w,height:w,speed:.8+level*.2,data:fT});}

function checkCollision(p,f){const dx=p.x-f.x,dy
