<!DOCTYPE html> 
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Pirarucu Aventureiro</title>

  <link rel="icon" type="image/png" href="logo 2.png" sizes="32x32">
  <link rel="apple-touch-icon" href="logo 2.png">
  <meta name="theme-color" content="#f59e0b">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
      font-family: 'Nunito', sans-serif;
      background-color: #0c4a6e;
    }

    #game-container {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      background-color: #0c4a6e;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }

    /* Fundo por orienta√ß√£o */
    @media (orientation: landscape) {
      canvas, .modal-water { background-image: url('Fundo pc.png'); }
    }
    @media (orientation: portrait) {
      canvas, .modal-water { background-image: url('Fundo do Lago.png'); }
    }

    .modal { transition: opacity .3s ease-in-out; }
    .particle { position: absolute; pointer-events: none; width: 5px; height: 5px; border-radius: 50%; animation: fade 1s forwards; }
    @keyframes fade { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(.5) translateY(-50px); } }
  </style>
</head>

<body>

<!-- Modal Nome -->
<div id="name-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120]">
  <div class="rounded-lg p-6 text-center shadow-xl max-w-sm w-full bg-cover bg-center modal-water">
    <div class="bg-white bg-opacity-80 p-4 shadow-md">
      <div class="flex justify-center mb-4"><img src="logo 2.png" class="w-[210px] h-auto shadow-lg" alt=""></div>
      <h2 class="text-2xl font-bold mb-4">üêü Bem-vindo!</h2>
      <p class="mb-4">Digite seu nome para come√ßar:</p>
      <input id="player-name-input" class="border-2 border-blue-500 rounded-lg px-4 py-2 w-full mb-4 text-center" maxlength="20" placeholder="Seu nome" autofocus>
      <button id="name-submit-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Continuar</button>
      <button id="view-ranking-name-modal" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Ver Ranking</button>
      <!-- Desenvolvido por -->
      <p class="mt-4 text-xs text-gray-500">
        Desenvolvido por <strong>J√∫lia Maretti Louvem</strong> e <strong>Yan Ribeiro de Paiva</strong>
      </p>
    </div>
  </div>
</div>

<!-- Container do jogo -->
<div id="game-container" class="hidden">
  <!-- HUD -->
  <div class="p-3 bg-blue-200/80 text-gray-800 flex justify-between items-center z-20">
    <div class="flex items-center gap-2">
      <img src="logo 2.png" class="w-8 h-8 object-contain" alt="">
      <div>
        <h1 class="text-lg font-bold">Pirarucu Aventureiro</h1>
        <div class="text-xs">Jogador: <span id="player-name-display" class="font-bold">-</span></div>
        <div class="text-xs">N√≠vel: <span id="level">1</span></div>
      </div>
    </div>
    <div class="text-right">
      <div class="font-bold">Pontos: <span id="score">0</span></div>
      <div class="text-xs">Recorde: <span id="high-score">0</span></div>
    </div>
  </div>

  <!-- Canvas -->
  <div class="flex-1 relative overflow-hidden">
    <canvas id="gameCanvas" class="absolute inset-0 w-full h-full"></canvas>
  </div>

  <!-- Barra Hg -->
  <div class="absolute top-24 right-3 w-12 text-center z-20 pointer-events-none">
    <div class="text-white text-sm font-bold mb-1">Hg</div>
    <div class="relative h-64 w-6 bg-white bg-opacity-30 rounded-full overflow-hidden mx-auto border-2 border-white/50">
      <div id="mercury-bar" class="absolute bottom-0 w-full bg-red-600 transition-all duration-300" style="height:0%;"></div>
    </div>
    <div class="text-white text-xs mt-1"><span id="mercury-percent">0</span>%</div>
  </div>

  <div id="game-message"
       class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white text-3xl font-bold z-30 opacity-0 pointer-events-none text-center drop-shadow-lg">
  </div>
</div>

<!-- Modal In√≠cio -->
<div id="start-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl w-full max-w-md mx-auto">
    <img src="logo 2.png" class="mx-auto mb-4 w-40 h-auto shadow" alt="">
    <h2 class="text-2xl font-bold mb-2">üêü Pirarucu Aventureiro</h2>
   <div class="flex flex-col gap-3 text-left mb-4">
  <p class="font-bold text-green-600">
    üü¢ Peixes Seguros:Tambaqui, Pacu, Aruan√£
  </p>
  <p class="font-bold text-red-600">
    üî¥ Contaminados: Tucunar√©, Surubim, Piranha
  </p>
  <p class="font-bold text-yellow-600">
    üü° Cura: Castanha-de-Par√°
  </p>
</div>
    <p class="mb-3 text-sm">Colete peixes seguros e evite os contaminados. Caso sua contamina√ß√£o esteja alta use a castanha-do-par√° para diminuir!</p>
    <p class="mb-6 text-sm">Arraste o dedo ou o mouse para mover o Pirarucu.</p>
    <button id="start-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full">Come√ßar</button>
    <!-- Desenvolvido por -->
    <p class="mt-4 text-xs text-gray-500">
      Desenvolvido por <strong>J√∫lia Maretti Louvem</strong> e <strong>Yan Ribeiro de Paiva</strong>
    </p>
  </div>
</div>

<!-- Game Over -->
<div id="game-over-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[120] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl max-w-sm">
    <h2 class="text-2xl font-bold mb-2 text-red-600">Fim de Jogo</h2>
    <p>Jogador: <span id="final-player-name" class="font-bold">-</span></p>
    <p>Pontua√ß√£o: <span id="final-score" class="font-bold text-blue-600">0</span></p>
    <p>N√≠vel: <span id="final-level" class="font-bold">1</span></p>
    <button id="restart-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Jogar Novamente</button>
    <button id="view-ranking-button" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg w-full mb-2">Ver Ranking</button>
    <!-- Desenvolvido por -->
    <p class="mt-4 text-xs text-gray-500">
      Desenvolvido por <strong>J√∫lia Maretti Louvem</strong> e <strong>Yan Ribeiro de Paiva</strong>
    </p>
  </div>
</div>

<!-- Modal Ranking -->
<div id="ranking-modal" class="modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-[130] hidden opacity-0">
  <div class="bg-white rounded-lg p-6 text-center shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto">
    <h2 class="text-2xl font-bold mb-4 text-center">üèÜ Ranking de Jogadores</h2>
    <div id="ranking-list" class="space-y-2"></div>
    <button id="close-ranking-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg w-full mt-4">Fechar</button>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const canvas = document.getElementById("gameCanvas"),
        ctx = canvas.getContext("2d");
  const scoreEl = document.getElementById("score"),
        levelEl = document.getElementById("level"),
        mercuryBarEl = document.getElementById("mercury-bar"),
        mercuryPercentEl = document.getElementById("mercury-percent"),
        nameModal = document.getElementById("name-modal"),
        startModal = document.getElementById("start-modal"),
        gameOverModal = document.getElementById("game-over-modal"),
        rankingModal = document.getElementById("ranking-modal"),
        rankingList  = document.getElementById("ranking-list"),
        nameSubmitButton = document.getElementById("name-submit-button"),
        playerNameInput = document.getElementById("player-name-input"),
        startButton = document.getElementById("start-button"),
        restartButton = document.getElementById("restart-button"),
        viewRankingButton = document.getElementById("view-ranking-button"),
        viewRankingNameBtn = document.getElementById("view-ranking-name-modal"),
        closeRankingButton = document.getElementById("close-ranking-button"),
        playerNameDisplay = document.getElementById("player-name-display");

  let playerName = "", player, score = 0, level = 1, mercury = 0, fish = [], gameRunning = false;

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();

  const fishData = [
    { name: "Tambaqui", points: 10, mercury: 0, color: "rgba(0, 255, 0, 0.5)" },
    { name: "Pacu", points: 10, mercury: 0, color: "rgba(0, 255, 0, 0.5)" },
    { name: "Aruan√£", points: 15, mercury: 0, color: "rgba(0, 255, 0, 0.5)" },
    { name: "Castanha", points: 20, mercury: -10, color: "rgba(255, 255, 0, 0.5)" },
    { name: "Tucunar√©", points: -5, mercury: 25, color: "rgba(255, 0, 0, 0.5)" },
    { name: "Surubim", points: -5, mercury: 30, color: "rgba(255, 0, 0, 0.5)" },
    { name: "Piranha", points: -5, mercury: 20, color: "rgba(255, 0, 0, 0.5)" }
  ];

  const fishImages = {
    'Aruan√£': new Image(),
    'Castanha': new Image(),
    'Pacu': new Image(),
    'Piranha': new Image(),
    'Surubim': new Image(),
    'Tambaqui': new Image(),
    'Tucunar√©': new Image()
  };

  fishImages['Aruan√£'].src = 'Aruana.png';
  fishImages['Castanha'].src = 'Castanha.png';
  fishImages['Pacu'].src = 'Pacu.png';
  fishImages['Piranha'].src = 'Piranha.png';
  fishImages['Surubim'].src = 'Surubim.png';
  fishImages['Tambaqui'].src = 'Tambaqui.png';
  fishImages['Tucunar√©'].src = 'Tucunare.png';

  player = { x: window.innerWidth / 2, y: window.innerHeight - 120, w: 160, h: 160, targetX: window.innerWidth / 2 };

  const img = new Image();
  img.src = "pirarucu m.png";

  function drawPlayer() {
    if (img.complete) ctx.drawImage(img, player.x - player.w / 2, player.y - player.h / 2, player.w, player.h);
  }

  let fishSpawnRate = 0.02;
  let fishSpeed = 2 + level * 0.2;
  let castanhaChance = 0.05;

  function createFish() {
    if (Math.random() < fishSpawnRate) {
      const isCastanha = Math.random() < castanhaChance;
      const d = isCastanha ? fishData.find(f => f.name === 'Castanha') : fishData[Math.floor(Math.random() * fishData.length)];
      fish.push({ x: Math.random() * canvas.width, y: -50, dy: fishSpeed, data: d });
      castanhaChance = Math.max(0.01, castanhaChance - 0.005 * level); 
    }
  }

  function drawFish(f) {
    ctx.fillStyle = f.data.color;
    ctx.beginPath();
    ctx.arc(f.x, f.y, 45, 0, Math.PI * 2);
    ctx.fill();

    // Halo suave opcional (transparente)
    ctx.save();
    ctx.globalAlpha = 0.25;
    const grad = ctx.createRadialGradient(f.x, f.y, 30, f.x, f.y, 70);
    grad.addColorStop(0, 'rgba(255,255,255,0.35)');
    grad.addColorStop(1, 'rgba(255,255,255,0.0)');
    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.arc(f.x, f.y, 70, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();

    // Imagem do peixe (por cima)
    const imgF = fishImages[f.data.name];
    if (imgF && imgF.complete && imgF.naturalWidth > 0) {
      ctx.drawImage(imgF, f.x - 45, f.y - 45, 90, 90);
    }
  }

  function checkCollision(f) {
    const dx = f.x - player.x, dy = f.y - player.y, dist = Math.sqrt(dx * dx + dy * dy);
    return dist < 90;
  }

  function showMessage(msg, color) {
    const el = document.getElementById("game-message");
    el.textContent = msg;
    el.style.color = color;
    el.style.opacity = 1;
    setTimeout(() => el.style.opacity = 0, 1000);
  }

  function loop() {
    if (!gameRunning) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    player.x += (player.targetX - player.x) * 0.1;
    drawPlayer();

    fish.forEach((f, i) => {
      f.y += f.dy;
      drawFish(f);
      if (checkCollision(f)) {
        score += f.data.points;
        mercury = Math.max(0, Math.min(100, mercury + f.data.mercury));
        showMessage(`${f.data.points > 0 ? '+' : ''}${f.data.points} pts`, f.data.mercury > 0 ? "#f00" : "#0f0");
        fish.splice(i, 1);
        if (mercury >= 100) endGame();
      } else if (f.y > canvas.height + 60) {
        fish.splice(i, 1);
      }
    });

    createFish();  
    mercuryBarEl.style.height = mercury + "%";
    mercuryPercentEl.textContent = mercury;
    scoreEl.textContent = score;

    if (score >= level * 100) levelUp();
    requestAnimationFrame(loop);
  }

  function startGame() {
    score = 0;
    level = 1;
    mercury = 0;
    fish = [];
    gameRunning = true;
    startModal.classList.add("hidden");
    resizeCanvas();
    loop();
  }

  function levelUp() {
    level++;
    levelEl.textContent = level;
    fishSpeed = 2 + level * 0.2;
    showMessage(`N√≠vel ${level}!`, "#0f0");
  }

  function endGame() {
    gameRunning = false;
    document.getElementById("final-score").textContent = score;
    document.getElementById("final-level").textContent = level;
    document.getElementById("final-player-name").textContent = playerName;
    gameOverModal.classList.remove("hidden");
    gameOverModal.style.opacity = 1;
    saveRanking();
  }

  function saveRanking() {
    const ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    ranking.push({ name: playerName, score, level });
    ranking.sort((a, b) => b.score - a.score);
    localStorage.setItem('ranking', JSON.stringify(ranking.slice(0, 10)));
  }

  // --------- RANKING: fun√ß√µes e eventos (bot√£o do nome + bot√£o do game over) ----------
  function getRanking(){
    try { return JSON.parse(localStorage.getItem('ranking') || '[]'); }
    catch(e){ return []; }
  }

  function renderRanking(){
    const data = getRanking();
    rankingList.innerHTML = '';
    if (!data.length){
      rankingList.innerHTML = '<p class="text-gray-500">Nenhum registro ainda. Jogue para entrar no ranking!</p>';
      return;
    }
    data.forEach((entry, idx) => {
      const div = document.createElement('div');
      div.className = 'p-3 rounded-lg border border-gray-200 flex justify-between items-center';
      const medal = idx===0?'ü•á':idx===1?'ü•à':idx===2?'ü•â':`${idx+1}¬∫`;
      div.innerHTML = `
        <div class="flex items-center gap-2">
          <span class="text-xl font-bold">${medal}</span>
          <div>
            <div class="font-bold">${entry.name || '‚Äî'}</div>
            <div class="text-xs text-gray-500">N√≠vel ${entry.level ?? 1}</div>
          </div>
        </div>
        <div class="font-bold text-blue-600">${entry.score ?? 0} pts</div>
      `;
      rankingList.appendChild(div);
    });
  }

  function openRanking(){
    renderRanking();
    rankingModal.classList.remove('hidden');
    requestAnimationFrame(()=> rankingModal.style.opacity = '1');
  }

  function closeRanking(){
    rankingModal.style.opacity = '0';
    setTimeout(()=> rankingModal.classList.add('hidden'), 300);
  }

  if (viewRankingNameBtn) viewRankingNameBtn.addEventListener('click', openRanking);
  if (viewRankingButton)   viewRankingButton.addEventListener('click', openRanking);
  if (closeRankingButton)  closeRankingButton.addEventListener('click', closeRanking);

  // --------- Controles ---------
  canvas.addEventListener("mousemove", e => player.targetX = e.clientX);
  canvas.addEventListener("touchmove", e => {
    const t = e.touches[0];
    if (t) player.targetX = t.clientX;
  });

  nameSubmitButton.onclick = () => {
    const n = playerNameInput.value.trim();
    if (!n) { alert("Digite seu nome!"); return; }
    playerName = n;
    playerNameDisplay.textContent = n;
    nameModal.classList.add("hidden");
    startModal.classList.remove("hidden");
    startModal.style.opacity = 1;
  };

  playerNameInput.addEventListener("keydown", e => {
    if (e.key === "Enter") nameSubmitButton.click();
  });

  startButton.onclick = startGame;
  restartButton.onclick = () => {
    gameOverModal.classList.add("hidden");
    startGame();
  };
});
</script>

</body>
</html>
